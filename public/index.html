<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BARRACUDA FAMILY | GTA 5 RP</title>
    <style>
        :root {
            --primary: #00ff88;
            --dark: #0a0a0a;
            --gray: #1a1a1a;
            --text: #ffffff;
            --danger: #ff4444;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        
        body {
            background-color: var(--dark);
            color: var(--text);
            overflow-x: hidden;
        }

        /* Анімації */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes glow { 0% { box-shadow: 0 0 5px var(--primary); } 50% { box-shadow: 0 0 20px var(--primary); } 100% { box-shadow: 0 0 5px var(--primary); } }

        /* Навігація */
        nav {
            background: rgba(0,0,0,0.9);
            padding: 20px;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 2px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo { font-size: 24px; font-weight: bold; color: var(--primary); text-transform: uppercase; letter-spacing: 2px; }
        .nav-links button {
            background: none; border: none; color: white; margin-left: 20px; cursor: pointer; font-size: 16px; transition: 0.3s;
        }
        .nav-links button:hover { color: var(--primary); }

        /* Контейнер */
        .container { max-width: 1200px; margin: 100px auto; padding: 20px; min-height: 80vh; }

        /* Секції */
        .section { display: none; animation: fadeIn 0.5s ease; }
        .section.active { display: block; }

        /* Герой блок */
        .hero { text-align: center; padding: 50px 0; }
        .hero h1 { font-size: 60px; color: var(--primary); text-shadow: 0 0 10px var(--primary); margin-bottom: 20px; }
        .btn-main {
            padding: 15px 40px; background: var(--primary); color: var(--dark); border: none;
            font-size: 18px; font-weight: bold; cursor: pointer; clip-path: polygon(10% 0, 100% 0, 100% 80%, 90% 100%, 0 100%, 0 20%);
            transition: 0.3s; text-transform: uppercase;
        }
        .btn-main:hover { transform: scale(1.05); box-shadow: 0 0 20px var(--primary); }

        /* Картки та форми */
        .card { background: var(--gray); padding: 20px; margin-bottom: 20px; border-left: 4px solid var(--primary); }
        .form-group { margin-bottom: 15px; }
        input, textarea, select {
            width: 100%; padding: 10px; background: #000; border: 1px solid #333; color: white; margin-top: 5px;
        }
        input:focus, textarea:focus { border-color: var(--primary); outline: none; }

        /* Таблиці */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; background: var(--gray); }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #333; }
        th { color: var(--primary); text-transform: uppercase; }
        tr:hover { background: #222; }

        /* Статуси */
        .status-pending { color: orange; }
        .status-accepted { color: var(--primary); }
        .status-rejected { color: var(--danger); }

        /* Кнопки дій */
        .btn-sm { padding: 5px 10px; cursor: pointer; border: none; color: white; font-size: 12px; margin-right: 5px; }
        .btn-green { background: green; }
        .btn-red { background: var(--danger); }
        .btn-blue { background: blue; }

        /* Повідомлення про ліміт */
        .alert { background: var(--danger); color: white; padding: 10px; margin-bottom: 10px; display: none; text-align: center; }
    </style>
</head>
<body>

    <nav>
        <div class="logo">BARRACUDA FAMILY</div>
        <div class="nav-links" id="navLinks">
            <button onclick="showSection('home')">Головна</button>
            <button onclick="showSection('news')">Новини</button>
            <button onclick="showSection('members')">Склад</button>
            <button onclick="showSection('apply')">Вступ</button>
            <button id="adminBtn" style="display:none;" onclick="showSection('admin')">Адмінка</button>
            <button id="authBtn" onclick="showSection('login')">Вхід</button>
            <button id="logoutBtn" style="display:none;" onclick="logout()">Вихід</button>
        </div>
    </nav>

    <div class="container">
        <div id="home" class="section active">
            <div class="hero">
                <h1>BARRACUDA</h1>
                <p>Елітна сім'я GTA 5 RP. Ми — закон вулиць.</p>
                <br>
                <button class="btn-main" onclick="showSection('apply')">Приєднатися</button>
            </div>
            <div class="card">
                <h3>Про нас</h3>
                <p>Найвпливовіша організація штату. Ми контролюємо бізнес, території та поважаємо лише силу і вірність.</p>
            </div>
        </div>

        <div id="news" class="section">
            <h2>Новини Сім'ї</h2>
            <div id="newsFeed"></div>
        </div>

        <div id="members" class="section">
            <h2>Наш Склад</h2>
            <table>
                <thead>
                    <tr>
                        <th>Ім'я</th>
                        <th>Ранг</th>
                        <th>Дата вступу</th>
                        <th>Статус</th>
                    </tr>
                </thead>
                <tbody id="membersTablePublic"></tbody>
            </table>
        </div>

        <div id="apply" class="section">
            <div class="card">
                <h2>Заявка на вступ</h2>
                <div class="form-group">
                    <label>Ваше Ім'я (IC):</label>
                    <input type="text" id="applyName" placeholder="Name_Surname">
                </div>
                <div class="form-group">
                    <label>Ваш Discord:</label>
                    <input type="text" id="applyDiscord" placeholder="user#0000">
                </div>
                <div class="form-group">
                    <label>Чому саме ми?</label>
                    <textarea id="applyReason" rows="4"></textarea>
                </div>
                <button class="btn-main" onclick="submitApplication()">Відправити</button>
            </div>
        </div>

        <div id="admin" class="section">
            <h2>Панель Керування (BOSS)</h2>
            
            <div class="card">
                <h3>Управління Новинами</h3>
                <input type="text" id="newsTitle" placeholder="Заголовок">
                <textarea id="newsContent" placeholder="Текст новини"></textarea>
                <br><br>
                <button class="btn-sm btn-green" onclick="addNews()">Опублікувати</button>
            </div>

            <div class="card">
                <h3>Заявки на вступ</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Ім'я</th>
                            <th>Discord</th>
                            <th>Причина</th>
                            <th>Дії</th>
                        </tr>
                    </thead>
                    <tbody id="adminApplicationsTable"></tbody>
                </table>
            </div>

            <div class="card">
                <h3>Управління складом</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Ім'я</th>
                            <th>Ранг</th>
                            <th>Дії</th>
                        </tr>
                    </thead>
                    <tbody id="adminMembersTable"></tbody>
                </table>
            </div>
        </div>

        <div id="login" class="section">
            <div class="card" style="max-width: 400px; margin: 0 auto;">
                <h2>Вхід в систему</h2>
                <div id="loginAlert" class="alert"></div>
                <input type="text" id="loginUser" placeholder="Логін">
                <input type="password" id="loginPass" placeholder="Пароль">
                <br><br>
                <button class="btn-main" onclick="login()">Увійти</button>
                <p style="margin-top: 10px; font-size: 14px;">Немає акаунту? <a href="#" onclick="showSection('register')" style="color: var(--primary);">Реєстрація</a></p>
            </div>
        </div>

        <div id="register" class="section">
            <div class="card" style="max-width: 400px; margin: 0 auto;">
                <h2>Створення акаунту</h2>
                <div id="regAlert" class="alert"></div>
                <input type="text" id="regUser" placeholder="Придумайте Логін">
                <input type="password" id="regPass" placeholder="Придумайте Пароль">
                <input type="text" id="regKey" placeholder="Секретний ключ (не обов'язково)">
                <br><br>
                <button class="btn-main" onclick="register()">Зареєструватися</button>
            </div>
        </div>
    </div>

    <script>
        // --- БАЗА ДАНИХ (LocalStorage) ---
        const DB = {
            get: (key) => JSON.parse(localStorage.getItem(key)) || [],
            set: (key, data) => localStorage.setItem(key, JSON.stringify(data)),
            init: () => {
                // 1. Ініціалізація Учасників (1 Учасник за замовчуванням)
                if (!localStorage.getItem('members')) {
                    const defaultMember = [
                        { id: 1, name: 'Don_Barracuda', rank: 'Boss', date: new Date().toLocaleDateString(), status: 'Online' }
                    ];
                    DB.set('members', defaultMember);
                }
                
                // 2. Ініціалізація новин
                if (!localStorage.getItem('news')) {
                    DB.set('news', [
                        { id: 1, title: 'Ми відкрились!', content: 'Сім\'я Barracuda починає набір.', date: new Date().toLocaleDateString() }
                    ]);
                }

                // 3. Ініціалізація користувачів (порожньо спочатку)
                if (!localStorage.getItem('users')) {
                    DB.set('users', []);
                }
            }
        };

        let currentUser = JSON.parse(sessionStorage.getItem('currentUser'));

        // --- ФУНКЦІЇ СИСТЕМИ ---

        function init() {
            DB.init();
            checkAuth();
            renderAll();
        }

        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            renderAll(); // Оновити дані при переході
        }

        // --- АВТОРИЗАЦІЯ (ЛІМІТ 1 АКАУНТ) ---

        function register() {
            const user = document.getElementById('regUser').value;
            const pass = document.getElementById('regPass').value;
            const key = document.getElementById('regKey').value;
            const alertBox = document.getElementById('regAlert');

            if (!user || !pass) {
                showAlert(alertBox, 'Заповніть всі поля!');
                return;
            }

            const users = DB.get('users');

            // ПЕРЕВІРКА ЛІМІТУ
            if (users.length >= 1) {
                showAlert(alertBox, 'ПОМИЛКА: Дозволено лише 1 акаунт на сайті! Зверніться до адміністратора.');
                return;
            }

            // Створення акаунту
            const role = (key === 'admin123' || users.length === 0) ? 'admin' : 'user'; // Перший завжди адмін
            const newUser = { user, pass, role };
            
            users.push(newUser);
            DB.set('users', users);
            
            alert('Акаунт створено! Увійдіть.');
            showSection('login');
        }

        function login() {
            const user = document.getElementById('loginUser').value;
            const pass = document.getElementById('loginPass').value;
            const users = DB.get('users');
            const alertBox = document.getElementById('loginAlert');

            const foundUser = users.find(u => u.user === user && u.pass === pass);

            if (foundUser) {
                sessionStorage.setItem('currentUser', JSON.stringify(foundUser));
                currentUser = foundUser;
                checkAuth();
                showSection('home');
            } else {
                showAlert(alertBox, 'Невірний логін або пароль!');
            }
        }

        function logout() {
            sessionStorage.removeItem('currentUser');
            currentUser = null;
            checkAuth();
            showSection('login');
        }

        function checkAuth() {
            const authBtn = document.getElementById('authBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            const adminBtn = document.getElementById('adminBtn');

            if (currentUser) {
                authBtn.style.display = 'none';
                logoutBtn.style.display = 'inline-block';
                if (currentUser.role === 'admin') {
                    adminBtn.style.display = 'inline-block';
                }
            } else {
                authBtn.style.display = 'inline-block';
                logoutBtn.style.display = 'none';
                adminBtn.style.display = 'none';
            }
        }

        function showAlert(element, msg) {
            element.innerText = msg;
            element.style.display = 'block';
            setTimeout(() => element.style.display = 'none', 3000);
        }

        // --- ФУНКЦІОНАЛ (CRUD) ---

        // 1. Заявки
        function submitApplication() {
            const name = document.getElementById('applyName').value;
            const discord = document.getElementById('applyDiscord').value;
            const reason = document.getElementById('applyReason').value;

            if (!name || !discord) { alert('Заповніть поля!'); return; }

            const apps = DB.get('applications');
            apps.push({ id: Date.now(), name, discord, reason, status: 'pending' });
            DB.set('applications', apps);

            alert('Заявку відправлено! Лідер розгляне її.');
            document.getElementById('applyName').value = '';
            showSection('home');
        }

        function handleApp(id, action) {
            let apps = DB.get('applications');
            const appIndex = apps.findIndex(a => a.id === id);
            if (appIndex === -1) return;

            const app = apps[appIndex];

            if (action === 'accept') {
                // Додаємо в учасники
                const members = DB.get('members');
                members.push({
                    id: Date.now(),
                    name: app.name,
                    rank: 'Novice',
                    date: new Date().toLocaleDateString(),
                    status: 'Active'
                });
                DB.set('members', members);
                apps.splice(appIndex, 1); // Видаляємо заявку
            } else {
                apps.splice(appIndex, 1); // Просто видаляємо
            }
            
            DB.set('applications', apps);
            renderAll();
        }

        // 2. Новини
        function addNews() {
            const title = document.getElementById('newsTitle').value;
            const content = document.getElementById('newsContent').value;

            if (!title) return;

            const news = DB.get('news');
            news.unshift({ id: Date.now(), title, content, date: new Date().toLocaleDateString() }); // Додаємо на початок
            DB.set('news', news);

            document.getElementById('newsTitle').value = '';
            document.getElementById('newsContent').value = '';
            renderAll();
            alert('Новину додано!');
        }

        // 3. Учасники (Кік/Ранг)
        function kickMember(id) {
            if(!confirm('Вигнати учасника?')) return;
            let members = DB.get('members');
            members = members.filter(m => m.id !== id);
            DB.set('members', members);
            renderAll();
        }

        function promoteMember(id) {
            let members = DB.get('members');
            const member = members.find(m => m.id === id);
            if (member) {
                member.rank = 'Member+'; // Спрощена логіка підвищення
                DB.set('members', members);
                renderAll();
            }
        }

        // --- ВІДОБРАЖЕННЯ (RENDER) ---

        function renderAll() {
            renderNews();
            renderMembers();
            if (currentUser && currentUser.role === 'admin') {
                renderAdminPanel();
            }
        }

        function renderNews() {
            const news = DB.get('news');
            const container = document.getElementById('newsFeed');
            container.innerHTML = news.map(n => `
                <div class="card">
                    <h3 style="color:var(--primary)">${n.title}</h3>
                    <small style="color:gray">${n.date}</small>
                    <p style="margin-top:10px">${n.content}</p>
                </div>
            `).join('');
        }

        function renderMembers() {
            const members = DB.get('members');
            const tbody = document.getElementById('membersTablePublic');
            tbody.innerHTML = members.map(m => `
                <tr>
                    <td>${m.name}</td>
                    <td><span style="color: var(--primary)">${m.rank}</span></td>
                    <td>${m.date}</td>
                    <td>${m.status}</td>
                </tr>
            `).join('');
        }

        function renderAdminPanel() {
            // Заявки
            const apps = DB.get('applications');
            document.getElementById('adminApplicationsTable').innerHTML = apps.map(a => `
                <tr>
                    <td>${a.name}</td>
                    <td>${a.discord}</td>
                    <td>${a.reason}</td>
                    <td>
                        <button class="btn-sm btn-green" onclick="handleApp(${a.id}, 'accept')">✔</button>
                        <button class="btn-sm btn-red" onclick="handleApp(${a.id}, 'reject')">✖</button>
                    </td>
                </tr>
            `).join('') || '<tr><td colspan="4">Заявок немає</td></tr>';

            // Учасники (для управління)
            const members = DB.get('members');
            document.getElementById('adminMembersTable').innerHTML = members.map(m => `
                <tr>
                    <td>${m.name}</td>
                    <td>${m.rank}</td>
                    <td>
                        <button class="btn-sm btn-blue" onclick="promoteMember(${m.id})">UP</button>
                        <button class="btn-sm btn-red" onclick="kickMember(${m.id})">Kick</button>
                    </td>
                </tr>
            `).join('');
        }

        // Запуск
        window.onload = init;
    </script>
</body>
</html>
